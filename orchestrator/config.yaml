models:
  list:
    - name: "kimi-k2"
      # OpenRouter model strings use the format: openrouter/<provider>/<model-name>
      # Full list: https://openrouter.ai/models
      model: "openrouter/moonshotai/kimi-k2.5"
      api_key_env: "OPENROUTER_API_KEY"
      max_tokens: 8192
    - name: "grok"
      model: "openrouter/x-ai/grok-code-fast-1"
      api_key_env: "OPENROUTER_API_KEY"
      max_tokens: 65536
    - name: "llama3"
      model: "ollama/llama3.2"
      api_key_env: ""
      max_tokens: 4096
    - name: "claude-sonnet"
      model: "anthropic/claude-sonnet-4-6"
      api_key_env: "ANTHROPIC_API_KEY"
      max_tokens: 8192
  # Each category maps a named model (by name in the list above) to the task
  # types it should handle. _select_model() in main.py resolves any model_key
  # ("default", "local", "remote") through this table.
  categories:
    - category: "default"
      # ORCHESTRATOR_MODEL env var overrides this at runtime without touching config.
      model: "grok"
      used_for: []
    - category: "local"
      model: "llama3"
      used_for:
        - "summarize"
        - "classify"
        - "reflect"
    - category: "remote"
      model: "kimi-k2"
      used_for:
        - "dev"
        - "research"
        - "plan"

paths:
  # Paths are evaluated relative to the orchestrator/ working directory.
  # The parent directory is included so agents can read ARCHITECTURE.md
  # and CLAUDE.md at the project root.
  allowed_read:
    - "./"
    - "../"
  allowed_write:
    - "./"
  db: "./storage/orchestrator.db"
  logs: "./logs/"

tools:
  shell_allowlist:
    - "pytest"
    - "python"
    - "git"
    - "ls"
    - "cat"
    - "grep"

agents:
  task_agent:
    allowed_tools:
      - "read_file"
      - "write_file"
      - "list_directory"
      - "git_status"
      - "git_diff"
      - "git_add"
      - "git_commit"
      - "git_branch"
      - "git_rollback"
      - "git_list_branches"
      - "git_log"
      - "run_tests"
      - "lint"
      - "check_syntax"
      - "notify_user"
    max_iterations: 100
    approval_required_for: ["high"]
  dev_agent:
    allowed_tools:
      - "read_file"
      - "write_file"
      - "list_directory"
      - "git_status"
      - "git_diff"
      - "git_add"
      - "git_commit"
      - "git_branch"
      - "git_rollback"
      - "git_list_branches"
      - "git_log"
      - "run_tests"
      - "lint"
      - "check_syntax"
      - "notify_user"
    max_iterations: 100
    approval_required_for: ["high"]

approval:
  # Terminal mode: blocks on stdin prompt. Replaced in later phases.
  mode: "terminal"

logging:
  # DEBUG emits full prompt dumps; INFO is the recommended production level.
  level: DEBUG

context:
  # when the combined context history exceeds these many tokens (currently 1 token == 4 characters) then invoke
  # a llm call to summarise the history, save it in the projects table in the db, and wipe the context history.
  recent_buffer_tokens: 4000
  summary_tokens: 1000
  brief_tokens: 500

projects:
  # All events without an explicit project_id accumulate history here.
  # Set to null to disable automatic project assignment.
  default_project_id: "default"
  default_project_name: "Default Project"

network:
  # Set enabled: false to run without any network listener (timer-only mode).
  enabled: true
  tcp:
    host: "127.0.0.1"
    port: 8080
  # UNIX domain socket path. Clients (e.g. curl --unix-socket) connect here.
  # Set to null to disable the UNIX socket listener.
  unix_socket: "/tmp/germinal.sock"
  # Seconds to wait for an agent response before returning a 504 to the HTTP client.
  request_timeout_s: 300
  # Set require_auth: true and provide an api_key to require Bearer token authentication.
  # Clients must send: Authorization: Bearer <api_key>
  require_auth: false
  api_key: ""
  # Name shown to clients in GET /v1/models and echoed back in responses.
  # The client must send this string in the model field (required by the OpenAI
  # protocol) but the orchestrator ignores it for routing and LLM selection.
  model_name: "germinal"
